# Lazy Window Join

## Code Structure

- benchmark -- application code to use the generated shared library
- cmake -- cmake configuration files
- docs -- any documents
- include -- all the header files
- src -- corresponding source files, will generate a shared library
- test -- test code based on google test
- tools -- script to start a remote-debug environment that contains all required libs.

## How to build

```shell
docker build -t clion/ubuntu/cpp-env:1.0 -f Dockerfile.cpp-env-ubuntu --build-arg UID=$(id -u) .
```

### Docker
First, build the docker with provided configuration
```shell
cd docker
./docker_est.sh
```
Then, you will have a docker image called adb_u2204_a, together with a container called aliancedb_u22_04_a

### For macOS
For macOS, we suggest to use docker with shared directory if you are not familiar with C++/Cmake/Boost/gflags
<br>build docker images 
<br>run docker with shared directory
```shell
docker run -it --rm -v local_shared_directory:docker_shared_directory/ adb_u2204_a
```
then build and make
```shell
cd docker_shared_direcotory/AllianceDB
mkdir build && cd build
cmake .. -DCMAKE_BUILD_TYPE=Release
make -j8
```

### Native Compile

```shell
mkdir build
cd build && cmake ..
make
```

### Cross Compile

```shell
mkdir CROSS_BUILD
cd CROSS_BUILD
export CC= {Full path and name of your cross C compiler}
export CXX= {Full path and name of your cross CPP compiler}
cmake .. -DENABLE_UNIT_TESTS=OFF
make
```




### Use by hand

You can start the docker container aliancedb_u22_04_a by run docker_run.sh, or delete it by run docker_est.sh.

Notes for this image:

- ssh is enabled via remote 22 port, you can run ifconfig inside the container to acquire its ip
- the project is NOT automatically copied to docker container, you should run docker cp or rsync manully

### Use in Clion
1. Configure the tool chain in Clion settings, choose the adb_u2204_a for image name
2. Configure a cmake using your pre-assigned docker
3. Reload the cmake project and select the build/debug to youe docker selection, enjoy!
## The document, please

The API document is generated by doxygen, and they can be found in the project website
https://intellistream.github.io/AllianceDB/

### Local generate

You can also re-generate them locally, if you have the doxygen and graphviz. Following are how to install them in ubuntu
21.10

```shell
sudo apt-get install doxygen
sudo apt-get install graphviz
```

Then, you can do

```shell
mkdir doc
doxygen Doxyfile
```

to get the documents in doc/html folder, and start at index.html

### Auto format

```bash
wget https://raw.githubusercontent.com/andrewseidl/githook-clang-format/master/clang-format.hook
cp clang-format.hook AllianceDB/.git/hooks/pre-commit
chmod +x AllianceDB/.git/hooks/pre-commit
```
